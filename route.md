## 路由匹配原则
 1. 最短掩码原则
 2. 路由优先级原则，数字越小优先级越高
 3. 最小metric原则

## 路由常用命令
### 查看路由
 1. route -n 
 2. ip route 
### 路由设置 
route add default gw 10.243.5.222 eth0
route add -net 10.243.39.96/27 gw 10.243.39.126 dev eth1
route add -p 10.243.39.96 mask 255.255.255.224  10.243.39.126
### 路由标志
 1. flag 标记[可选如下]
 ``` 
U - 路由是活动的
H - 目标是一个主机
G - 路由指向网关
R - 恢复动态路由产生的表项
D - 由动态路由后台程序动态的安装
M - 由路由的后台程序修改
! - 拒绝路由
 ```
 2. Metric 路由距离，到达指定网络需要的中转数[Linux内核中没有引用]
 3. Ref 路由项引用册数[Linux内核中没有引用]
 4. Use 次路由项被路由软件查找的次数
 5. Iface 该路由表项输出的路由接口。这里有几个特殊的iface值：  
   > - `-` 表示没有值
   > - `*` 表示丢弃，即blackhole黑洞路由

### 四种scope
 1. global 在任何场景下都有效，可以转发。如果目的地在另外一个网卡，则该路由可以匹配转发的要求，进行路由转发
 2. link   在链路上才有效，这个链路是指同一个端口，也就是说接受和发送都是走的同一个端口的时候该路由才生效。说明在同一个二层
 3. host   表示是一条本地路由，典型的是回环端口，loopback设备使用这种路由条目。约定在本机内部转发，不可能转发到外部。
 4. site   是ipv6专用的路由scope

## 策略路由
/etc/iproute2/rt_tables 是Linux系统路由表定义文件，其中0、253、254、255号表是Linux系统维护的表，1-252号表是自定义的表
 - man ip rule // 查看路由策略数据库管理命令
 - ip rule list //查看所有路由策略数据
 - ip route list table 0 //查看0号路由表中的路由信息
策略路由通常用于多个多个网口不同网络平面的连通性，或者不同vlan的路由设置。例如: 主机上有网卡eth0 10.243.5.201和网卡eth1 10.243.39.98，这两个地址分属不同的vlan. eth0的网关是10.243.5.222，eth1的网关是10.243.39.126. 默认路由只有设置一个，如下：
```
default via 10.243.5.222 dev eth0 
10.243.5.192/27 dev eth0  proto kernel  scope link  src 10.243.5.201 
10.243.39.96/27 dev eth1  proto kernel  scope link  src 10.243.39.98
```
这时需要设置策略路由，让10.243.39.98/27网段的数据走路由表16，在路由表16中设置eth1的默认网关：
```
ip route add default via 10.243.39.126 dev eth1 table 16
ip rule add from 10.243.39.98/27 lookup 16
